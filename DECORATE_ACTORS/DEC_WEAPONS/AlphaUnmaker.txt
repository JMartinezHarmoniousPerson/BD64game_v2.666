Actor LasergunSpawner : CustomInventory 9351
{
SpawnID 180
Scale 0.9
Inventory.PickupMessage "You got the Experimental Laser Gun"
Inventory.PickupSound "WPICK"
	States
	{
	Spawn:
		LGUN C 0 NoDelay A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)
		LGUN B 0
		"####" "#" 1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("IsTacticalClass",1,"Pickup2")
		TNT1 A 0 A_JumpIfInventory("IsModern",1,"Pickup2")
		TNT1 A 0 A_GiveInventory("Lasergun")
		Stop
	Pickup2:
		TNT1 A 0 A_GiveInventory("LasergunTactical")
		Stop
	}
}

Actor Lasergun : DoomWeapon
{
Scale 0.9
Weapon.SelectionOrder 200	//WAS 2900
Inventory.PickupMessage "You got the Experimental Laser Gun"
AttackSound "weapons/AlphaLZRGker"
Weapon.AmmoUse 1
Weapon.AmmoGive 40
Weapon.AmmoType "Cell"
Inventory.Icon LGUNB0	//R27 WAS LGUNA0
Tag "Laser Gun"			//R11 ADDED TAG
VisibleToPlayerClass "64DoomPlayer"												//R11 added
Inventory.ForbiddenTo "Tactical64DoomPlayer","Tactical64DoomPlayer_p","Modern"	//R11 added	//R15 added TACTICAL P	//R28 added MODERN
+INVENTORY.RESTRICTABSOLUTELY													//R12.1 added
	States
	{
	Spawn:
		LGUN B -1
		Stop
	Ready:
		HDLG A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRG A 0
		"####" A 1 A_WeaponReady
		Loop
	Select:
		HDLG A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRG A 0
		"####" A 1 A_Raise
		Wait
	Deselect:
		HDLG A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRG A 0
		"####" A 1 A_Lower
		Wait
	Fire:
		TNT1 A 0 A_GiveInventory("HasPlasmaWeapon",1)	//R31 LINE MOVED FROM SELECTANIMATION
		TNT1 A 0 A_ZoomFactor(0.99)
		TNT1 A 0 A_PlaySound("LSSTART",2)
		HDLG B 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)			//R31 Alternative Laser Skin
		LZRG B 0
		"####" BCD 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,1)	//R31 smooth animation
	Hold: //R31 smooth animation
		TNT1 A 0 A_PlaySound("LSLoop",CHAN_WEAPON,1,1)				//R31 SOUND FIX FOR GZ4.8
		HDLG E 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRG E 0
		"####" E 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,0)
		"####" D 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,1)
		"####" E 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,0)
		"####" A 0 A_Refire
		"####" A 0 A_StopSound(CHAN_WEAPON)	//R31 SOUND FIX FOR GZ4.8
		"####" A 0 A_PlaySound("LSStop",2)
		"####" A 0 A_ZoomFactor(1.0)
		"####" FGH 1 A_FireCustomMissile("GunFireSmoke",0,0,0,0,0,0)
		"####" A 2
		Goto Ready
	}
}

Actor LasergunTactical : Brutal64Weapon
{
Scale 0.9
Weapon.SelectionOrder 200	//WAS 2900
Inventory.PickupMessage "You got the Experimental Laser Gun"
AttackSound "weapons/AlphaLZRGker"
Weapon.AmmoUse 1
Weapon.AmmoGive 40
Weapon.AmmoType "Cell"
Inventory.Icon LGUNB0	//R27 WAS LGUNA0
Tag "Laser Gun"			//R11 ADDED TAG
+WEAPON.ALT_USES_BOTH	//R31 ADDED
+WEAPON.NOALERT			//R31 ADDED
+INVENTORY.RESTRICTABSOLUTELY	//R12.1 added
	States
	{
	KickingFlash:	//r31 new kick animations
		HDLR A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRS A 0
		"####" A 0
		"####" DCBA 1
		"####" A 8
		"####" ABCD 1
		Stop
	AirKickingFlash:
		HDLR A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRS A 0
		"####" A 0
		"####" DCBA 1
		"####" A 10
		"####" ABCD 1
		Stop
	SlideKickingStart:
		HDLR A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRS A 0
		"####" A 0
		"####" DCBA 1
		"####" A 18
	SlideKickingEnd:
		HDLR A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRS A 0
		"####" A 0
		"####" A 6
		"####" ABCD 1
		Stop
	Spawn:
		LGUN B -1
		Stop
	v1Ready:
	Ready:
		HDLG A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRG A 0
		"####" A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		Loop
	Select: //R31 Select Animation Improvement (Tactical and Modern only)
		TNT1 A 0 A_PlaySound("LSGREADY")
		TNT1 AAAAAAAA 0 A_Raise
	SelectAnimation:
		HDLR A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRS A 0
		"####" ABCD 1
		Goto Ready
	Deselect:
		HDLR A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRS A 0
		"####" DCBA 1
		TNT1 A 0 A_TakeInventory("HasPlasmaWeapon",1)
		TNT1 A 0 A_StopSoundEx("WEAPON")
		TNT1 A 1 A_Lower
		Wait
	Fire:
		TNT1 A 0 A_GiveInventory("HasPlasmaWeapon",1)	//R31 LINE MOVED FROM SELECTANIMATION
		TNT1 A 0 A_ZoomFactor(0.99)
		TNT1 A 0 A_PlaySound("LSSTART",2)
		HDLG B 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)			//R31 Alternative Laser Skin
		LZRG B 0
		"####" BCD 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,1)	//R31 smooth animation
	Hold: //R31 smooth animation
		TNT1 A 0 A_PlaySound("LSLoop",CHAN_WEAPON,1,1)				//R31 SOUND FIX FOR GZ4.8
		TNT1 A 0 A_AlertMonsters
		HDLG E 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRG E 0
		"####" E 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,0)
		"####" D 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,1)
		"####" E 1 Bright A_FireCustomMissile("AlphaLZRGkerLaser",0,0)
		"####" A 0 A_Refire
		"####" A 0 A_StopSound(CHAN_WEAPON)	//R31 SOUND FIX FOR GZ4.8
		"####" A 0 A_PlaySound("LSStop",2)
		"####" A 0 A_ZoomFactor(1.0)
		"####" FGH 1 A_FireCustomMissile("GunFireSmoke",0,0,0,0,0,0)
		"####" A 2
		Goto Ready
	AltFire:		//R31 ADDED ALTFIRE, Improvement animation
		TNT1 A 0 A_JumpIfInventory("CELL",15,2)
		TNT1 A 0 A_Print("Not Enough Ammo!",1)
		Goto Ready
		TNT1 A 0 A_GiveInventory("HasPlasmaWeapon",1)
		TNT1 A 0 A_JumpIfInventory("IsTacticalClass",1,2)
		TNT1 A 0 A_JumpIfInventory("IsModern",1,1)
		Goto Ready
		TNT1 A 0 A_PlaySound("RCHARGE",1,10)
		HDLZ A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LAZF A 0
		"####" A 1 Bright Offset(1,32)
		"####" A 1 Bright Offset(2,33)
		"####" A 1 Bright Offset(0,34)
		"####" A 1 Bright Offset(-1,33)
		"####" A 1 Bright Offset(0,32)
		"####" A 1 Bright Offset(1,32)
		"####" A 1 Bright Offset(2,33)
		"####" A 1 Bright Offset(0,34)
		"####" A 1 Bright Offset(-1,32)
		"####" A 1 Bright Offset(0,32)
		"####" A 1 Bright Offset(1,32)
		"####" A 1 Bright Offset(2,33)
		"####" A 1 Bright Offset(0,34)
		"####" A 1 Bright Offset(-1,32)
	AltHold:
		HDLZ A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LAZF A 0
		"####" A 0 A_JumpIfInventory("CELL",15,2)
		"####" A 0 A_Print("Not Enough Ammo!",1)
		Goto Ready
		"####" A 1 Bright Offset(0,32)
		"####" A 1 Bright Offset(1,32)
		"####" A 1 Bright Offset(2,33)
		"####" A 1 Bright Offset(0,34)
		"####" A 1 Bright Offset(-1,33)
		"####" A 1 Bright Offset(0,32)
		"####" A 1 Bright Offset(1,32)
		"####" A 1 Bright Offset(2,33)
		"####" A 1 Bright Offset(0,34)
		"####" A 1 Bright Offset(-1,33)
		"####" A 1 Bright Offset(0,32)
		"####" A 1 Bright Offset(1,32)
		"####" A 1 Bright Offset(2,33)
		"####" A 1 Bright Offset(0,34)
		"####" A 1 Bright Offset(-1,33)
		"####" A 1 Bright Offset(0,33)
		"####" A 0 A_ZoomFactor(0.9)
		"####" A 1 Bright Offset(0,40)
		TNT1 A 0 A_FireCustomMissile("EnergyBlast",0,0,0,-3,0,0)
		TNT1 A 0 A_TakeInventory("CELL",15,TIF_NOTAKEINFINITE)
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_FireCustomMissile("LaserTrail",0,0,0,0,0,0)
		HDLl A 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LSAL A 0
		"####" ABC 1 Bright A_FireCustomMissile("GunFireSmoke",0,0,0,0,0,0)
		"####" A 0 A_PlaySound("RBLAST",1)
		"####" D 1 A_SetPitch(1.0 + pitch)
		TNT1 A 0 A_ZoomFactor(1.0)
		HDLG F 0 A_JumpIf(CallACS("AlternativeLaserSkin")==true,2)	//R31 Alternative Laser Skin
		LZRG F 0
		"####" F 0 A_ReFire
		"####" FGH 1
		"####" AA 2 A_FireCustomMissile("GunFireSmoke",0,0,0,0,0,0)
		Goto Ready
	}
}

Actor AlphaLZRGkerLaser : FastProjectile 9954	//R1 WAS 9904
{
Scale 0.6
radius 1
height 1
speed 999
damage 2
Alpha 1
Renderstyle Add
Decal LaserDecal		//R31 was bulletchip
DamageType Plasma
SeeSound "weapons/AlphaLZRGker"
DeathSound ""
Obituary "%o was fried by %k's laser."	//R30.10 was LZRGde by %k.
PROJECTILE
+RANDOMIZE
+EXTREMEDEATH
+FORCERADIUSDMG
	States
	{
	Spawn:
		TNT1 A 1
		Loop
	Death:
		TNT1 AAAAAAAA 0 A_CustomMissile("ExplosionParticleLaser",0,0,random(0,360),2,random(0,180))
		TNT1 AAAAAAAAAAA 0 A_CustomMissile("ExplosionParticleHeavy",0,0,random(0,360),2,random(0,360))
		TNT1 AA 1 A_SpawnItem("RocketFlare")
		TNT1 A 0 A_SpawnItem("DetectFloorLaser")		//R28.2	//r31 was DetectFloorBullet
		TNT1 A 0 A_SpawnItem("DetectCeilLaser")		//R28.2	//r31 was DetectFloorBullet
		//TNT1 A 0 A_CustomMissile("ExplosionSmokeFast22",5,0,random(0,360),2,random(0,360))
		Stop
	}
}

Actor AlphaLZRGkerLaserTrail
{
Scale 0.6
Height 4
Radius 2
Speed 0
Damage 0
Alpha 1
RenderStyle Add
PROJECTILE
+RANDOMIZE
	states
	{
	Spawn:
		LAZR ABAB 1 Bright
		Stop
	Death:
		LPUF A 1 Bright
		Stop
	}
}

Actor EnergyBlast : PlasmaBall	//R31 ADDED
{
Scale 0.8
Speed 85
Damage 50
Height 7
Radius 7
Alpha 0.9
RenderStyle Add
Decal MedScorch
DamageType Plasma
+BLOODSPLATTER
+FORCERADIUSDMG
-DONTSPLASH
+NOGRAVITY
+BOUNCEONWALLS
+EXPLODEONWATER
Obituary "%o was barbequed by %k's Lasergun."
SeeSound ""
BounceFactor 0.95
ReactionTime 45
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_CountDown
		TNT1 A 0 A_SpawnItem("RocketFlare")
		TNT1 A 0 A_SpawnItem("LaserTrail")
		LEYS R 1 Bright A_SpawnItem("LaserTrail")
		TNT1 AAAAA 0 A_CustomMissile("ExplosionParticleLaser",0,0,random(0,360))
		TNT1 A 0 A_SpawnItem("Shoque")
		Loop
	Death:
		TNT1 A 0 A_PlaySound("DSFIRXPL",3)
		L2NR AB 3 Bright A_SpawnItem("RocketFlare")
		LENR AB 1 Bright A_SpawnItem("RocketFlare")
		TNT1 AAAAAAAAAA 0 A_CustomMissile("ExplosionParticleHeavy",2,0,random(0,360),2,random(0,180))
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("ExplosionParticleLaser",0,0,random(0,360),2,random(0,360))
		TNT1 A 0 A_CustomMissile("BigRicoChet")
		TNT1 A 1 A_Explode(100,70)
		TNT1 A 0 A_SpawnItem("Shoque")
		TNT1 A 0 A_SpawnItem("DetectFloorCraterMed")
		TNT1 A 0 A_SpawnItem("DetectCeilCraterMed")
		TNT1 A 0 A_SpawnItemEx("LiquidExplosionEffectSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		LPUF ABC 9 Bright A_CustomMissile("PlasmaSmoke",1,0,random(0,360),2,random(0,160))
		Stop
	}
}

Actor LaserTrail	//R31 ADDED
{
Scale 2.75
Height 7
Radius 7
Speed 80
Damage 0
Alpha 1
RenderStyle Add
PROJECTILE
+RANDOMIZE
	states
	{
	Spawn:
		LAZR AB 1 Bright A_SpawnItem("RocketFlare")
		Stop
	Death:
		LPUF A 1 Bright
		Stop
	}
}