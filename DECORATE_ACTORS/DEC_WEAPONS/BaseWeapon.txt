//R31
//Own Weapon Base for Tactical and Modern Classes
//restored bob from v1

Actor KickHasHit : Inventory
{
inventory.maxamount 1
}

Actor TossMine : Inventory
{
inventory.maxamount 1
}

Actor Brutal64Weapon : DoomWeapon
{
Weapon.BobStyle InverseSmooth
Weapon.BobSpeed 2.0
Weapon.BobRangeX 0.5
Weapon.BobRangeY 0.5
Inventory.forbiddento "64DoomPlayer"
VisibleToPlayerClass "Tactical64DoomPlayer","Tactical64DoomPlayer_P","Modern"	//R28 added MODERN
	States
	{
	Tired:
		TNT1 A 0 A_Print("Not enough stamina!",1)
		TNT1 A 0 A_PlaySound("Tired",2)
		TNT1 A 12
		Goto GetReady
	GetReady:
		TNT1 A 0 A_TakeInventory("Kicking",1)
		TNT1 A 0 A_TakeInventory("TossMine",1)
		TNT1 AAAA 1 A_Jump(256,"v1Ready")
		Loop
	Steady:
		TNT1 A 1
		Goto GetReady
	v1Ready:
		TNT1 A 1
		TNT1 A 0 A_Jump(256,"v1Ready")
		Loop
	DoKick:
		TNT1 A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_Takeinventory("Kicking",1)
		TNT1 A 0 A_Takeinventory("Zoomed",0)					//R11 unused	//R31 reactivated
		TNT1 A 0 A_JumpIfInventory("IsModern",1,"ModernCheck")	//R28 added
		TNT1 A 0 A_JumpIfInventory("istacticalclass",1,1)		//R7 added
		Goto GetReady											//R7 added
		TNT1 A 0 A_jumpifinventory("Stamina",80,"Tired")
		TNT1 A 0 A_GiveInventory("Stamina",20)
	ModernCheck:								//R28 added
		TNT1 A 0 A_JumpIf(momZ > 0,"AirKick")
		TNT1 A 0 A_JumpIf(momZ < 0,"AirKick")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,"SlideAttack")
		TNT1 A 0 A_JumpIf(pitch > 32,"LowKickChecker1")
		Goto InitializeNormalKick
	LowKickChecker1:
		TNT1 A 0 A_JumpIf(pitch > 90,"InitializeNormalKick")
		TNT1 A 0 A_FireCustomMissile("KickAttackDetectDowned",0,0,0,0)
	InitializeNormalKick:
		TNT1 A 0 A_GunFlash("KickingFlash")
		TNT1 A 0 A_jumpifinventory("PowerStrength",1,"BerserkerKick")
		TNT1 A 0 A_PlaySound("KICK")
		TNT1 A 0 SetPlayerProperty(0,1,0)
		KICK BCD 1
		TNT1 A 0 A_FireCustomMissile("KickAttack",0,0,0,-7)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		KICK I 5
		KICK HGFED 1
		KICK CBA 1
		TNT1 A 0 SetPlayerProperty(0,0,0)
		Goto GetReady
	BerserkerKick:
		TNT1 A 0 A_PlaySound("KICK")
		TNT1 A 0 SetPlayerProperty(0,1,0)
		KICK BCD 1
		TNT1 A 0 A_FireCustomMissile("SuperKickAttack",0,0,0,-7)
		TNT1 A 0 A_RadiusThrust(8000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		KICK I 5
		KICK HGFED 1
		KICK CBA 1
		TNT1 A 0 SetPlayerProperty(0,0,0)
		Goto GetReady
	AirKick:
		TNT1 A 0 A_JumpIfInventory("IsModern",1,2)
		TNT1 A 0 A_GiveInventory("Stamina",5)		//R17 WAS 20
		TNT1 A 0 A_GunFlash("AirKickingFlash")
		TNT1 A 0 A_jumpifinventory("PowerStrength",1,"SuperAirKick")
		TNT1 A 0 A_PlaySound("KICK")
		TNT1 A 0 A_Recoil(-6)
		KICK JKLMN 1
		TNT1 A 0 A_FireCustomMissile("AirKickAttack",0,0,0,-31)
		TNT1 A 0 A_RadiusThrust(4500,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		KICK O 3
		KICK PQRST 2
		Goto GetReady
	SuperAirKick:
		TNT1 A 0 A_PlaySound("KICK")
		TNT1 A 0 A_Recoil(-6)
		KICK JKLMN 1
		TNT1 A 0 A_FireCustomMissile("SuperAirKickAttack",0,0,0,-31)
		TNT1 A 0 A_RadiusThrust(9000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		KICK O 3
		KICK PQRST 2
		Goto GetReady
	SlideAttack:
		TNT1 A 0 SetPlayerProperty(0,1,0)
		TNT1 A 0 A_Takeinventory("Kicking",1)
		TNT1 A 0 A_PlaySound("KICK")
		TNT1 A 0 A_Recoil(-6)
		TNT1 A 0 A_PlaySound("SlideKickStart",5)
		TNT1 A 0 A_GunFlash("SlideKickingStart")
		SLID ABCDE 1
		TNT1 A 0 A_SetPItch(10)
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		Goto FinishSlide
		SLID F 1 A_FireCustomMissile("SlideAttack",0,0,0,10)
		TNT1 A 0 A_RadiusThrust(4000,70,RTF_NOTMISSILE|RTF_NOIMPACTDAMAGE)
		TNT1 A 0 A_Recoil(-2)
		TNT1 A 0 A_SetPItch(10)
		TNT1 A 0 A_JumpIfInventory("KickHasHit",1,"FinishSlideHitWall")
		TNT1 A 0 A_JumpIf(CallACS("CheckifCrouching")==true,1)
		TNT1 A 0 A_TakeInventory("KickHasHit",1)
		Goto FinishSlide
	FinishSlide:
		TNT1 A 0 A_PlaySound("SlideKickStop",5)
		TNT1 A 0 A_GunFlash("SlideKickingEnd")
		SLID EDCBA 2
		TNT1 A 0 SetPlayerProperty(0,0,0)
		Goto GetReady
	FinishSlideHitwall:
		TNT1 A 0 A_Stop
		TNT1 A 0 A_GunFlash("SlideKickingEnd")
		SLID EDCBA 2
		TNT1 A 0 A_TakeInventory("KickHasHit",1)
		TNT1 A 0 SetPlayerProperty(0,0,0)
		Goto GetReady
	TossMine:
		"----" A 0 A_TakeInventory("TossMine",1)
		"----" A 0 A_JumpIfInventory("64MineAmmo",1,2)
		"----" A 0 A_Print("No Mines in inventory!")
		Goto GetReady
		"----" A 0 A_Takeinventory("HasPlasmaWeapon",1)
		TNT1 A 0 A_GunFlash("MineThrowFlash")
		TNT1 A 5
		TNT1 A 0 A_Takeinventory("Zoomed",1)
		TNT1 A 0 A_ZoomFactor(1.0)
		LMNS ABCDE 1
		LMNF ABCD 1
		LMNF D 1 Offset(0,33)
		LMNF D 1 Offset(0,34)
		LMNF D 1 Offset(0,35)
		LMNF D 3 Offset(0,36)
		LMNF D 1 Offset(0,35)
		LMNF D 1 Offset(0,34)
		LMNF D 1 Offset(0,33)
		LMNF EFG 1
		TNT1 A 0 A_TakeInventory("64MineAmmo",1,TIF_NOTAKEINFINITE)
		TNT1 A 0 A_FireCustomMissile("64ThrownProxMine",0,0,0,0,0,0)
		LMNF HIJKLMNOPQRS 1
		TNT1 A 5
		Goto GetReady
	}
}